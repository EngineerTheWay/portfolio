---
const today = new Date();
import contactIconRaw from "../../assets/icons/contact-icon.svg?raw";
import Button from "../ui/button/Button.astro";

function sanitizeToWhite(svg: string, size = 18) {
  let s = svg
    .replace(/<\?xml[\s\S]*?\?>/g, "")
    .replace(/<!--([\s\S]*?)-->/g, "")
    .replace(/width=\"[^\"]*\"/g, "")
    .replace(/height=\"[^\"]*\"/g, "")
    // Ensure shapes are visible: use white via currentColor on fill, drop strokes
    .replace(/fill=\"[^\"]*\"/gi, 'fill="currentColor"')
    .replace(/stroke=\"[^\"]*\"/gi, 'stroke="none"');
  s = s.replace(/<svg([^>]*)>/, (m, attrs) => `<svg${attrs} width="${size}" height="${size}">`);
  return s;
}

const feedUrl = new URL('rss.xml', Astro.site).toString();
---

<footer id="contact" class="py-12 px-4 text-center">
  <h2 class="text-2xl md:text-3xl font-semibold text-foreground">Want to contact me?</h2>
  <p class="mt-2 text-[color:var(--color-text-muted)]">You can reach me via LinkedIn!</p>

  <!-- Big CTA button for LinkedIn -->
  <div class="mt-6 flex justify-center">
    <Button href="https://www.linkedin.com/in/waycaleb/" variant="secondary" size="md">
      <span class="inline-flex mr-2 relative bottom-[3px]" aria-hidden="true">
        <!-- LinkedIn SVG -->
        <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
          <path d="M4.983 3.5C4.983 4.88 3.88 6 2.5 6S0 4.88 0 3.5 1.12 1 2.5 1 4.983 2.12 4.983 3.5zM.25 8.25h4.5V24h-4.5V8.25zm7.75 0h4.312v2.144h.062c.6-1.137 2.062-2.312 4.25-2.312 4.544 0 5.375 2.987 5.375 6.875V24h-4.5v-8.25c0-1.963-.037-4.5-2.75-4.5-2.75 0-3.188 2.15-3.188 4.375V24h-4.5V8.25z"/>
        </svg>
      </span>
      Connect with me!
    </Button>
  </div>

  <!-- Credits -->
  <div class="mt-6 text-sm text-[color:var(--color-text-muted)]">
    Â© 2025 Caleb Way. All rights reserved. Forked from <a href="https://guihubie.com" class="hover:text-[color:var(--accent)]">guihubie</a>.
  </div>

  <!-- Footer buttons -->
  <div class="mt-6 flex items-center justify-center gap-5 text-sm">
    <a
      class="sw-btn-sm"
      href="https://github.com/EngineerTheWay"
      target="_blank"
      rel="noopener noreferrer"
      aria-label="Go to GitHub"
    >
      GitHub
    </a>

    <a
      class="sw-btn-sm"
      href="mailto:contact@calebway.io?subject=Portfolio%20Inquiry"
      aria-label="Send me an email"
    >
      Email
    </a>

    <button
      class="sw-btn-sm"
      type="button"
      data-copy={feedUrl}
      aria-label="Copy RSS link"
    >
      Copy RSS
    </button>
  </div>
</footer>

  <script type="module">
    document.addEventListener('click', (e) => {
      const target = e.target;
      if (!(target instanceof HTMLElement)) return;
      if (target.matches('button[data-copy]')) {
        const url = target.getAttribute('data-copy');
        if (!url) return;
        navigator.clipboard?.writeText(url);
        const original = target.textContent || 'Copy RSS link';
        target.textContent = 'Copied!';
        setTimeout(() => { target.textContent = original; }, 1500);
      }
    });
  </script>
</footer>
